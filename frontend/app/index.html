<!DOCTYPE html>
<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script type="text/javascript" src="js/d3.geo.js"></script>
	<script type="text/javascript" src="js/main.js"></script>
	<link type="text/css" rel="stylesheet" href="css/main.css"/>
	<!--<link type="text/css" rel="stylesheet" href="css/style.css"/>-->
	<link type="text/css" rel="stylesheet" href="css/colorbrewer.css"/>
	<style type="text/css">

		svg {
			width: 800px;
			 height: 800px;
			pointer-events: all;
		}

		circle {
			fill: #dbe4f0;
		}

		path {
			fill: #aaa;
			stroke: #fff;
		}


		h1 {
			font-family:arial;
			font-size:2em;
			color:#ffffff;
		}

		#info {
			position:absolute;
			top: 10px;
			left: 10px;
		}

		.states {
			fill: #e5e5e5;
			stroke: #fff;
			stroke-width:1px;
		}

		.states:hover {
			fill: steelblue;
		}


	</style>
</head>
<body>

<div id="body">
	<div id="info"><span id="name"></span></div>
	<div id="sidebar"> 
		<div class="tagcloud">   
			<div id="htmltagcloud">  <span id="0" class="wrd tagcloud0"> 				<a
					href="#tagcloud">adaptogen</a></span> <span id="1" class="wrd tagcloud0"> 				<a
					href="#tagcloud">bag</a></span> <span id="2" class="wrd tagcloud0"> 			<a href="#tagcloud">beard</a></span>
				<span id="3" class="wrd tagcloud6"> 			<a href="#tagcloud">booth</a></span> <span id="4"
																										   class="wrd tagcloud0"> 			<a
						href="#tagcloud">brooklyn</a></span> <span id="5" class="wrd tagcloud10"> 			<a
						href="#tagcloud">cardigan</a></span>  <span id="6" class="wrd tagcloud0"> 				<a
						href="#tagcloud">carry</a></span>  <span id="7" class="wrd tagcloud6"> 				<a
						href="#tagcloud">chia</a></span> <span id="8" class="wrd tagcloud0"> 			<a
						href="#tagcloud">chicken</a></span>  <span id="9" class="wrd tagcloud0"> 				<a
						href="#tagcloud">cleanse</a></span>  <span id="10" class="wrd tagcloud0"> 				<a
						href="#tagcloud">cliche</a></span> <span id="11" class="wrd tagcloud6"> 			<a
						href="#tagcloud">coffee</a></span> <span id="12" class="wrd tagcloud0"> 			<a
						href="#tagcloud">cold-pressed</a></span>  <span id="13" class="wrd tagcloud0"><a
						href="#tagcloud">cred</a></span>  <span id="14" class="wrd tagcloud0"> 				<a
						href="#tagcloud">drinking</a></span> <span id="15" class="wrd tagcloud6"> 			<a
						href="#tagcloud">enamel</a></span> <span id="16" class="wrd tagcloud0"> 			<a
						href="#tagcloud">ethical</a></span> <span id="17" class="wrd tagcloud6"> 			<a
						href="#tagcloud">food</a></span>  <span id="18" class="wrd tagcloud0"><a href="#tagcloud">heirloom</a></span> 
				<span id="19" class="wrd tagcloud0"> 				<a href="#tagcloud">hoodie</a></span> <span id="20"
																												 class="wrd tagcloud0"> 			<a
						href="#tagcloud">humblebrag</a></span>  <span id="21" class="wrd tagcloud0"><a href="#tagcloud">iphone</a></span> 
				<span id="22" class="wrd tagcloud6"> 				<a href="#tagcloud">irony</a></span> <span id="23"
																												class="wrd tagcloud6"> 			<a
						href="#tagcloud">kogi</a></span> <span id="24" class="wrd tagcloud0"> 			<a
						href="#tagcloud">master</a></span>  <span id="25" class="wrd tagcloud6"><a href="#tagcloud">meggings</a></span> 
				<span id="26" class="wrd tagcloud0"><a href="#tagcloud">meh</a></span> <span id="27"
																							 class="wrd tagcloud6"> 			<a
						href="#tagcloud">mixtape</a></span>  <span id="28" class="wrd tagcloud0"><a href="#tagcloud">party</a></span> 
				<span id="29" class="wrd tagcloud0"> 				<a href="#tagcloud">pbr</a></span> <span id="30"
																											  class="wrd tagcloud6"> 			<a
						href="#tagcloud">photo</a></span> <span id="31" class="wrd tagcloud6"> 			<a 				href="#tagcloud">pin</a></span>
				<span id="32" class="wrd tagcloud0"> 			<a href="#tagcloud">polaroid</a></span>  <span id="33"
																												class="wrd tagcloud6"><a
						href="#tagcloud">portland</a></span>  <span id="34" class="wrd tagcloud0"> 				<a
						href="#tagcloud">pug</a></span> <span id="35" class="wrd tagcloud0"> 			<a
						href="#tagcloud">semiotics</a></span> <span id="36" class="wrd tagcloud0"> 			<a
						href="#tagcloud">shorts</a></span> <span id="37" class="wrd tagcloud6"> 			<a
						href="#tagcloud">single-origin</a></span>  <span id="38" class="wrd tagcloud0"><a
						href="#tagcloud">tattooed</a></span>  <span id="39" class="wrd tagcloud0"> 				<a
						href="#tagcloud">tbh</a></span> <span id="40" class="wrd tagcloud6"> 			<a
						href="#tagcloud">tilde</a></span> <span id="41" class="wrd tagcloud6"> 			<a
						href="#tagcloud">truck</a></span>  <span id="42" class="wrd tagcloud0"><a
						href="#tagcloud">trust</a></span>  <span id="43" class="wrd tagcloud0"><a href="#tagcloud">tumblr</a></span>
				<span id="44" class="wrd tagcloud0"> 			<a href="#tagcloud">twee</a></span>  <span id="45"
																											class="wrd tagcloud0"><a
						href="#tagcloud">vaporware</a></span>  <span id="46" class="wrd tagcloud0"> 				<a
						href="#tagcloud">venmo</a></span> <span id="47" class="wrd tagcloud0"> 			<a
						href="#tagcloud">vexillologist</a></span>  <span id="48" class="wrd tagcloud0"><a
						href="#tagcloud">vinegar</a></span>  <span id="49" class="wrd tagcloud0"> 				<a
						href="#tagcloud">viral</a></span> 
			</div>
			    
		</div>
		 
		<div class="newsfeed">

		</div>
		 
	</div>
	<div id="footer">
		<div><select>
			<option value="equalarea">equalarea</option>
			<option value="equidistant">equidistant</option>
			<option value="gnomonic">gnomonic</option>
			<option value="orthographic" selected>orthographic</option>
			<option value="stereographic">stereographic</option>
		</select></div>
	</div>
</div>

<script src='js/crossfilter.js' type='text/javascript'></script>
<script src='js/dc.js' type='text/javascript'></script>
<script src='js/data-processing.js' type='text/javascript'></script>
<script type="text/javascript">

    var width = window.innerWidth ;//960, //1280 
		height = window.innerHeight;//800;
	var scale = 300;
    var feature;

    var projection = d3.geo.azimuthal()
        .scale(scale)
        .origin([-71.03,42.37])
        .mode("orthographic")
        .translate([400, 350]);

    var circle = d3.geo.greatCircle()
        .origin(projection.origin());

    // TODO fix d3.geo.azimuthal to be consistent with scale
    var scale = {
        orthographic: scale,
        stereographic: scale,
        gnomonic: scale,
        equidistant: scale / Math.PI * 2,
        equalarea: scale / Math.SQRT2
    };

    var path = d3.geo.path()
        .projection(projection);

    var svg = d3.select("#body").append("svg:svg")
        .attr("width", width)
        .attr("height", height)
        .on("mousedown", mousedown);

	d3.json("json/data.json", function(newscollection) {
	   	console.log(newscollection);
	});
    d3.json("json/world-countries.json", function(collection) {
        feature = svg.selectAll("path")
            .data(collection.features)
            .enter()
            .append("svg:path")
            .attr('class', 'states')
            .attr("d", clip)
            .on('mouseover', function(d){
                var name = d.properties.name;
                return document.getElementById('name').innerHTML=name;
            });

        feature.append("svg:title")
            .text(function(d) { return d.properties.name; });
    });

    d3.select(window)
        .on("mousemove", mousemove)
        .on("mouseup", mouseup);

    d3.select("select").on("change", function() {
        projection.mode(this.value).scale(scale[this.value]);
        refresh(750);
    });

    var m0,
        o0;

    function mousedown() {
        m0 = [d3.event.pageX, d3.event.pageY];
        o0 = projection.origin();
        d3.event.preventDefault();
    }

    function mousemove() {
        if (m0) {
            var m1 = [d3.event.pageX, d3.event.pageY],
                o1 = [o0[0] + (m0[0] - m1[0]) / 8, o0[1] + (m1[1] - m0[1]) / 8];
            projection.origin(o1);
            circle.origin(o1)
            refresh();
        }
    }

    function mouseup() {
        if (m0) {
            mousemove();
            m0 = null;
        }
    }

    function refresh(duration) {
        (duration ? feature.transition().duration(duration) : feature).attr("d", clip);
    }

    function clip(d) {
        return path(circle.clip(d));
    }

</script>
</body>
</html>
